## Семинар 3

### Задача 1

a. $\hat{b}_0 = 48$ и $\hat{b}_1 = 1.5$.

Значение $\hat{b}_0 = 48$ – среднее 
ожидаемое значение балла за эссе в случае, если оно длиной 0 дюймов. Нереалистично, но 
профессор Бинс не безгрешен, бывает, засыпает при проверке и ставит баллы рандомно.

Значение $\hat{b}_1 = 1.5$ – предельный эффект длины эссе на набранный балл; при увеличении 
длины эссе на один дюйм, балл за него, в среднем, увеличивается на 1.5 балла.

b.  Известно, что длина эссе Гермионы составляет 32 дюйма. 
Какой балл, в среднем, она может ожидать
согласно данной модели?

$$\widehat{score_i} = 48 + 1.5\cdot 32 = 96$$ (Эльфы, успокаивающего зелья Гермионе!)

### Задача 2

a. Зависимая – число побед, независимая – число часов практики.

b.  При $x = 2$ значение $y = \hat{y} = 6$, при $x = 4$ значение $y = 9$, 
$\hat{y} = 8$, при $x=7$ значение $y = 10$, $\hat{y} = 11$.

c. $\sum_i \varepsilon_i^2 = \sum_i (y_i - \hat{y})_i^2 = (6-6)^2 + (9-8)^2 + (14-10)^2 + (10-11)^2 = 18$.

d. Уравнение прямой $\hat{y}_i = 4 +  x_i.$

### Задача 3

a. Заметим, что возраст – это независимая переменная $x$, а зарплата – зависимая переменная $y$.

$$
\hat{b}_1 = \frac{Cov(x, y)}{s_x^2} = \frac{4}{25} = 0.16.
$$

$$
\hat{b}_0 = \bar{y} - \hat{b}_1 \cdot \bar{x} = 5 - 0.16 \cdot 30 = 0.2.
$$

$$
\hat{y}_i = 0.2 + 0.16 \cdot x_i.
$$

$$
\widehat{SALARY}_i = 0.2 + 0.16 \cdot AGE_i.
$$

b. Константа неинтерпретируема (вряд ли будет сотрудник с нулевым возрастом), 
при увеличении возраста на один год заработная плата, в среднем, увеличивается на 0.16 тысяч кнатов.

### Задача 4

a. Вычислите $\bar{x}$ и $\bar{y}$, то есть средние арифметические выборок.

$$
\bar{x} = 36 \text{ и } \bar{y} = 40
$$

b. Добавьте в таблицу столбец ($x - \bar{x}$), то есть посчитайте для 
каждого наблюдения отклонения от среднего выборки $x$. Заодно добавим столбец 
($y - \bar{y}$), он нам понадобится:


| id | $x$ | $y$ | $(x-\bar{x})$ | $(y-\bar{y})$ |
|:--:|:---:|:---:|:-------------:|:-------------:|
|  1 |  60 |  80 |       24      |       40      |
|  2 |  30 |  20 |      $-6$     |     $-20$     |
|  3 |  25 |  15 |     $-11$     |     $-25$     |
|  4 |  25 |  25 |     $-11$     |     $-15$     |
|  5 |  40 |  60 |       4       |       20      |

c. Вычислите $\hat{b}_0$, $\hat{b}_1$, то есть оценки коэффициентов регрессии.

$$
\hat{b_1} = \frac{\sum\limits_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sum\limits_{i=1}^{n}(x_i - \bar{x})^2}
$$

Посчитаем отдельно числитель и знаменатель:

$$
\sum\limits_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y}) = 24 \cdot 40 + (-6)(-20) + (-11)(-25) + (-11)(-15) + 4 \cdot 20 = 1600
$$

$$
\sum\limits_{i=1}^{n}(x_i - \bar{x})^2 = 24^2 +(-6)^2 + (-11)^2 + (-11)^2 + 4^2 = 870
$$

Подставим и посчитаем $\hat{b}_1$:

$$
\hat{b_1} = \frac{\sum\limits_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sum\limits_{i=1}^{n}(x_i - \bar{x})^2} =
\frac{1600}{870} \approx 1.84
$$

Теперь посчитаем $\hat{b}_0$:

$$
\hat{b_0} = \bar{y} - \hat{b}_1 \times \bar{x} = 40 - 1.84 \times 36 = -26.24.
$$

d. Запишите уравнение регрессии, используя оценки коэффициентов из предыдущего пункта. 
Добавьте в таблицу столбец $\hat{y}$, то есть посчитайте для каждого наблюдения значение $y$, которое ожидается согласно нашей модели. 

$$
\hat{y}_i = \hat{b_0} + \hat{b_1} \times x_i
$$

$$
\hat{y}_i = -26.24 + 1.84 \times x_i
$$

Подставим вместо $x_i$ значения $x$ из таблицы и посчитаем $\hat{y}_i $:

| id | $x$ | $y$ | $(x-\bar{x})$ | $(y-\bar{y})$ | $\hat{y}$ |
|:--:|:---:|:---:|:-------------:|:-------------:|:---------:|
|  1 |  60 |  80 |       24      |       40      |   84.16   |
|  2 |  30 |  20 |      $-6$     |     $-20$     |   28.96   |
|  3 |  25 |  15 |     $-11$     |     $-25$     |   19.76   |
|  4 |  25 |  25 |     $-11$     |     $-15$     |   19.76   |
|  5 |  40 |  60 |       4       |       20      |   47.36   |

e. Добавьте в таблицу столбец $\hat{\varepsilon}$, то есть посчитайте для каждого наблюдения значение ошибки ($y-\hat{y}$), которую совершает модель, предсказывая значения $y$ на основе значений $x$. 

| id | $x$ | $y$ | $(x-\bar{x})$ | $(y-\bar{y})$ | $\hat{y}$ | $\hat{\varepsilon}$ |
|:--:|:---:|:---:|:-------------:|:-------------:|:---------:|:-------------------:|
|  1 |  60 |  80 |       24      |       40      |   84.16   |       $-4.16$       |
|  2 |  30 |  20 |      $-6$     |     $-20$     |   28.96   |       $-8.96$       |
|  3 |  25 |  15 |     $-11$     |     $-25$     |   19.76   |       $-4.76$       |
|  4 |  25 |  25 |     $-11$     |     $-15$     |   19.76   |        $5.24$       |
|  5 |  40 |  60 |       4       |       20      |   47.36   |       $12.64$       |

e. Посчитайте сумму квадратов остатков модели.

$$
\sum\limits_{i=1}^{n}\hat{\varepsilon_i}^2 = (-4.16)^2 + (-8.96)^2 + (-4.76)^2 + 5.24^2 + 12.64^2 = 307.472
$$
